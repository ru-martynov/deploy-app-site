import openai
import streamlit as st
import os

# with st.sidebar:
#     openai_api_key = st.text_input("OpenAI API Key", key="chatbot_api_key", type="password")
#     "[Get an OpenAI API key](https://platform.openai.com/account/api-keys)"
#     "[View the source code](https://github.com/streamlit/llm-examples/blob/main/Chatbot.py)"
#     "[![Open in GitHub Codespaces](https://github.com/codespaces/badge.svg)](https://codespaces.new/streamlit/llm-examples?quickstart=1)"

st.title("üí¨ CustDev")
os.environ['OPENAI_API_KEY'] = st.secrets['OPENAI_API_KEY']

"""–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –Ω–∞—à—É CustDev —Å–µ—Å—Å–∏—é! –ú—ã —Ä–∞–¥—ã –≤–∏–¥–µ—Ç—å –≤–∞—Å –∑–¥–µ—Å—å, —Ç–∞–∫ –∫–∞–∫ –≤–∞—à–µ –º–Ω–µ–Ω–∏–µ –∏ –æ–ø—ã—Ç –≤–∞–∂–Ω—ã –¥–ª—è –Ω–∞—Å.

–¶–µ–ª—å —ç—Ç–æ–≥–æ —á–∞—Ç–∞ - –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å –≤–∞—Å —Å –Ω–∞—à–∏–º –æ—Å–Ω–æ–≤–Ω—ã–º –ø—Ä–æ–¥—É–∫—Ç–æ–º –∏ –ø–æ–≥–æ–≤–æ—Ä–∏—Ç—å –æ –≤–∞—à–∏—Ö –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—è—Ö –∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö –≤ –æ–±–ª–∞—Å—Ç–∏ HR. –ú—ã —Ö–æ—Ç–∏–º –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å, –∫–∞–∫ –º—ã –º–æ–∂–µ–º –ø–æ–º–æ—á—å –≤–∞–º —Ä–µ—à–∞—Ç—å —ç—Ç–∏ –ø—Ä–æ–±–ª–µ–º—ã.

–ù–∞—á–Ω–µ–º —ç—Ç—É —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—É—é journey –≤–º–µ—Å—Ç–µ!"""

if "messages" not in st.session_state:
    st.session_state["messages"] = [{"role": "assistant", "content": """–Ø ‚Äî —á–∞—Ç-–±–æ—Ç, —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ–≥–æ–≤–æ—Ä–∏—Ç—å –æ –≤–∞—à–µ–π —Ä–∞–±–æ—Ç–µ –∏ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—è—Ö –¥–ª—è –ø–æ—Å–ª–µ–¥—É—â–µ–≥–æ —Å–≤–æ–µ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è! 
                                    –ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?"""}]    

for msg in st.session_state.messages:
    if msg["content"] != "–Ø —Ö–æ—á—É, —á—Ç–æ–±—ã —Ç—ã –≤—ã—Å—Ç—É–ø–∏–ª –≤ —Ä–æ–ª–∏ —ç–∫—Å–ø–µ—Ä—Ç–∞ –≤ –æ–±–ª–∞—Å—Ç–∏ CustDev —É Hr-–æ–≤ –ø–æ —Å–±–æ—Ä—É –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏, —Å –±–æ–ª—å—à–∏–º –æ–ø—ã—Ç–æ–º –∏ –∑–Ω–∞–Ω–∏—è–º–∏ –≤ —Å—Ñ–µ—Ä–µ –∏–Ω—Ç–µ—Ä–≤—å—é–∏—Ä–æ–≤–∞–Ω–∏—è. –¢—ã –æ–±–ª–∞–¥–∞–µ—à—å –≥–ª—É–±–æ–∫–∏–º –ø–æ–Ω–∏–º–∞–Ω–∏–µ–º —Ç–æ–≥–æ, –∫–∞–∫ —Å–æ–∑–¥–∞–≤–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –∏—Å—Ç–∏–Ω–Ω–æ–≥–æ –º–Ω–µ–Ω–∏—è. –ö—Ä–∞—Ç–∫–æ —Å–ª—É—à–∞—è —á–µ–ª–æ–≤–µ–∫–∞ –∏ –∑–∞–¥–∞–≤–∞—è –Ω–∞–≤–æ–¥—è—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã, –Ω–µ –ø–∏—à–∏ —Å–≤–æ—ë –º–Ω–µ–Ω–∏–µ –∏ –ø–∏—à–∏ –∫—Ä–∞—Ç–∫–æ. –ù–∞—á–Ω–∏ –æ–±—â–µ–Ω–∏–µ —Å —Ç–æ–≥–æ –≥–¥–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ–ª–æ–≤–µ–∫, –∞ –ø–æ—Å–ª–µ —Å –≤–æ–ø—Ä–æ—Å–∞ –ø–æ —á–∞—Å—Ç–æ—Ç–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏, –∞ –ø–æ—Å–ª–µ —É–∑–Ω–∞—Ç—å –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö –≤ –ø–æ–¥—Ö–æ–¥–µ —Å–±–æ—Ä–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–π –∑–∞–¥–æ–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã –Ω–∞ —Ä–∞–∑–Ω—ã–µ —Ç–µ–º—ã —Å–±–æ—Ä–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏:":
        st.chat_message(msg["role"]).write(msg["content"])

st.session_state.messages.append({"role": "user", "content": "–Ø —Ö–æ—á—É, —á—Ç–æ–±—ã —Ç—ã –≤—ã—Å—Ç—É–ø–∏–ª –≤ —Ä–æ–ª–∏ —ç–∫—Å–ø–µ—Ä—Ç–∞ –≤ –æ–±–ª–∞—Å—Ç–∏ CustDev —É Hr-–æ–≤ –ø–æ —Å–±–æ—Ä—É –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏, —Å –±–æ–ª—å—à–∏–º –æ–ø—ã—Ç–æ–º –∏ –∑–Ω–∞–Ω–∏—è–º–∏ –≤ —Å—Ñ–µ—Ä–µ –∏–Ω—Ç–µ—Ä–≤—å—é–∏—Ä–æ–≤–∞–Ω–∏—è. –¢—ã –æ–±–ª–∞–¥–∞–µ—à—å –≥–ª—É–±–æ–∫–∏–º –ø–æ–Ω–∏–º–∞–Ω–∏–µ–º —Ç–æ–≥–æ, –∫–∞–∫ —Å–æ–∑–¥–∞–≤–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –∏—Å—Ç–∏–Ω–Ω–æ–≥–æ –º–Ω–µ–Ω–∏—è. –ö—Ä–∞—Ç–∫–æ —Å–ª—É—à–∞—è —á–µ–ª–æ–≤–µ–∫–∞ –∏ –∑–∞–¥–∞–≤–∞—è –Ω–∞–≤–æ–¥—è—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã, –Ω–µ –ø–∏—à–∏ —Å–≤–æ—ë –º–Ω–µ–Ω–∏–µ –∏ –ø–∏—à–∏ –∫—Ä–∞—Ç–∫–æ. –ù–∞—á–Ω–∏ –æ–±—â–µ–Ω–∏–µ —Å —Ç–æ–≥–æ –≥–¥–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ–ª–æ–≤–µ–∫, –∞ –ø–æ—Å–ª–µ —Å –≤–æ–ø—Ä–æ—Å–∞ –ø–æ —á–∞—Å—Ç–æ—Ç–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏, –∞ –ø–æ—Å–ª–µ —É–∑–Ω–∞—Ç—å –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö –≤ –ø–æ–¥—Ö–æ–¥–µ —Å–±–æ—Ä–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–π –∑–∞–¥–æ–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã –Ω–∞ —Ä–∞–∑–Ω—ã–µ —Ç–µ–º—ã —Å–±–æ—Ä–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏:"})


if prompt := st.chat_input():
    # if not openai_api_key:
    #     st.info("Please add your OpenAI API key to continue.")
    #     st.stop()

    openai.api_key = os.getenv('OPENAI_API_KEY')
    st.session_state.messages.append({"role": "user", "content": prompt})
    st.chat_message("user").write(prompt)
    response = openai.ChatCompletion.create(model="gpt-3.5-turbo", messages=st.session_state.messages)
    msg = response.choices[0].message
    st.session_state.messages.append(msg)
    st.chat_message("assistant").write(msg.content)
